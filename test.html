<html>

	<body onload='main()'>
		<button id='fileSelect'>Open file</button>
		<div id='result'></div>
	</body>
</html>

<script>
	function main()
	{
		document.getElementById("fileSelect").addEventListener("click", onFileOpen);
	}

	let voxHandle = null;
	let customHandle = null;
	let objHandle = null;
	async function onFileOpen(evt)
	{
		let newVoxHandle = null;
		let newCustomHandle = null;
		let newObjHandle = null;
		try
		{
			newVoxHandle = await chooseFileSystemEntries({ type: "openFile", excludeAcceptAllOption: true, accepts: [{ description: "MagicaVoxel model", extensions: ["vox"]}] });
			try
			{
				newCustomHandle = await chooseFileSystemEntries({ type: "openFile", excludeAcceptAllOption: true, accepts: [{ description: "MagicaVoxel smooth customization", extensions: ["mvSmooth"]}] });
			}
			catch (exception)
			{
			}
			newObjHandle = await chooseFileSystemEntries({ type: "saveFile", excludeAcceptAllOption: true, accepts: [{ description: "Exported OBJ", extensions: ["obj"]}] });
			voxHandle = newVoxHandle;
			customHandle = newCustomHandle;
			objHandle = newObjHandle;
			document.getElementById("result").innerHTML = "vox = " + newVoxHandle.name + " :: customization = " + (customHandle?customHandle.name:"none") + " :: object export = " + objHandle.name;
		}
		catch (exception)
		{
		}
	}
</script>